BootStrap: docker
From: rocker/geospatial:latest

%files
    /ddn/gs1/tools/set/R432/lib64/R/library /R_packages


%post
    # Update package list
    apt-get update

    # Install locales and generate the necessary locale
    apt-get install -y locales
    locale-gen en_US.UTF-8

    # Install fonts for Unicode support
    apt-get install -y fonts-dejavu fonts-liberation fonts-noto fonts-unifont

    # Set locale for the environment
    echo "LANG=en_US.UTF-8" >> /etc/default/locale
    echo "LC_ALL=en_US.UTF-8" >> /etc/default/locale
    export LANG=en_US.UTF-8
    export LC_ALL=en_US.UTF-8


    mkdir /pipeline
    mkdir /input
    mkdir /opt/_targets

    Rscript -e "install.packages(c('pak','targets','tarchetypes','crew','crew.cluster'))"
    Rscript -e "pak::pkg_install('NIEHS/amadeus')"
    Rscript -e "remotes::install_github('NIEHS/beethoven')"



   
%environment
    # Set locale for the container environment
    export LANG=en_US.UTF-8
    export LC_ALL=en_US.UTF-8
    export TERM=xterm-256color

%runscript

%labels
  basic geospatial with targets and crew plus unicode text so the target progress prints nicely